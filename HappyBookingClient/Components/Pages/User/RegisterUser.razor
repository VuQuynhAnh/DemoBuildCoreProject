@page "/register-user"
@rendermode @(new InteractiveServerRenderMode(prerender: false))
@using MudBlazor

<MudCard>
    <MudForm Model="@model" @ref="@form" ValidationDelay="0">
        <MudCardContent>
            <MudTextField @bind-Value="model.Name"
                          For="@(() => model.Name)"
                          Immediate="true"
                          Label="Name" />

            <MudTextField @bind-Value="model.Email"
                          For="@(() => model.Email)"
                          Immediate="true"
                          Label="Email" />

            <MudTextField @bind-Value="model.CCNumber"
                          For="@(() => model.CCNumber)"
                          Immediate="true"
                          Label="Credit card nr" />

            <MudTextField @bind-Value="model.Address.Address"
                          For="@(() => model.Address.Address)"
                          Immediate="true"
                          Label="Address" />

            <MudTextField @bind-Value="model.Address.City"
                          For="@(() => model.Address.City)"
                          Immediate="true"
                          Label="City" />

            <MudTextField @bind-Value="model.Address.Country"
                          For="@(() => model.Address.Country)"
                          Immediate="true"
                          Label="Country" />
        </MudCardContent>
    </MudForm>
    <MudCardActions>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" OnClick="@(async () => await Submit())">Order</MudButton>
    </MudCardActions>
</MudCard>

@code {
    [Inject] ISnackbar Snackbar { get; set; }

    MudForm form;

    OrderModel model = new OrderModel();

    public class OrderModel
    {
        public string Name { get; set; }
        public string Email { get; set; }
        public string CCNumber { get; set; } = "4012 8888 8888 1881";
        public AddressModel Address { get; set; } = new AddressModel();
        public List<OrderDetailsModel> OrderDetails = new List<OrderDetailsModel>()
        {
            new OrderDetailsModel()
                {
                    Description = "Perform Work order 1",
                    Offer = 100
                },
            new OrderDetailsModel()
        };
    }

    public class AddressModel
    {
        public string Address { get; set; }
        public string City { get; set; }
        public string Country { get; set; }
    }

    public class OrderDetailsModel
    {
        public string Description { get; set; }
        public decimal Offer { get; set; }
    }

    private async Task Submit()
    {
        await form.Validate();

        if (form.IsValid)
        {
            Snackbar.Add("Submited!");
        }
    }

}